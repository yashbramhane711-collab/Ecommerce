{% extends "base.html" %}

{% block title %}{{ product.name }} - E-Commerce Store{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-6">
        {% if product.image %}
        <img src="{{ product.image }}" class="img-fluid rounded" alt="{{ product.name }}">
        {% else %}
        <div class="bg-light d-flex align-items-center justify-content-center rounded" style="height: 400px;">
            <i class="bi bi-image" style="font-size: 4rem;"></i>
        </div>
        {% endif %}
    </div>
    <div class="col-md-6">
        <h2>{{ product.name }}</h2>
        <p class="text-muted">Category: {{ product.category }}</p>
        <h3 class="text-primary">${{ "%.2f"|format(product.price) }}</h3>
        
        <div class="mb-3">
            <span class="badge bg-{% if product.stock > 10 %}success{% elif product.stock > 0 %}warning{% else %}danger{% endif %}">
                {{ product.stock }} in stock
            </span>
        </div>
        
        <p>{{ product.description }}</p>
        
        {% if current_user.is_authenticated and product.stock > 0 %}
        <form action="{{ url_for('cart.add_to_cart', product_id=product.id) }}" method="POST" class="mb-3">
            <div class="row align-items-center">
                <div class="col-auto">
                    <label for="quantity" class="form-label">Quantity:</label>
                </div>
                <div class="col-auto">
                    <input type="number" id="quantity" name="quantity" class="form-control" 
                           value="1" min="1" max="{{ product.stock }}" style="width: 80px;">
                </div>
                <div class="col-auto">
                    <button type="submit" class="btn btn-primary btn-lg">Add to Cart</button>
                </div>
            </div>
        </form>
        {% elif not current_user.is_authenticated %}
        <div class="alert alert-info">
            Please <a href="{{ url_for('auth.login') }}">login</a> to add products to your cart.
        </div>
        {% else %}
        <div class="alert alert-warning">
            This product is currently out of stock.
        </div>
        {% endif %}
        
        {% if current_user.is_authenticated and current_user.is_admin %}
        <div class="mt-3">
            <a href="{{ url_for('product.edit_product', id=product.id) }}" class="btn btn-warning">Edit Product</a>
            <a href="{{ url_for('product.delete_product', id=product.id) }}" class="btn btn-danger" 
               onclick="return confirm('Are you sure you want to delete this product?')">Delete Product</a>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}